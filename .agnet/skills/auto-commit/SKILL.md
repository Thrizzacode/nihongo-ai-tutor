---
name: auto-commit
description: å…¨è‡ªå‹•åŒ– Git æµç¨‹åŠ©æ‰‹ã€‚ä¾æ“š Angular è¦ç¯„ç”Ÿæˆ Commitï¼Œè‡ªå‹•è™•ç† Push èˆ‡ PR ç™¼é€ã€‚
version: 2.2.0
---

# Auto Commit Skill (Git Automator)

## Trigger Keywords

- `commit`
- `å¹«æˆ‘commit`

## Context & Constraints

- **æ ¸å¿ƒç›®æ¨™**ï¼šå°‡ä»£ç¢¼å¾ Local å®‰å…¨ã€è¦ç¯„åœ°é€å¾€ Remoteï¼Œä¸¦å¯ä¸€éµç™¼ PRã€‚
- **å„ªå…ˆç´š**ï¼šå„ªå…ˆåˆ†ææš«å­˜å€ (Staging Area)ï¼Œè‹¥ç‚ºç©ºå‰‡åˆ†æå·¥ä½œå€ (Working Directory)ã€‚
- **Token å„ªåŒ–**ï¼šé¿å…ä¸€æ¬¡æ€§è®€å–éå¤š Diff å°è‡´ä¸Šä¸‹æ–‡æº¢å‡ºã€‚
- **å®‰å…¨æ€§**ï¼šåœ¨åŸ·è¡Œ `git add -A` å‰éœ€ç¢ºä¿ä½¿ç”¨è€…çŸ¥æƒ…ã€‚

## Instructions

### Step 1: ç’°å¢ƒæƒæèˆ‡ç‹€æ…‹åµæ¸¬

1.  **ç²å–ç•¶å‰åˆ†æ”¯**ï¼šåŸ·è¡Œ `git rev-parse --abbrev-ref HEAD` ç²å–ç•¶å‰åˆ†æ”¯åç¨± (è¨˜ç‚º `{{current_branch}}`)ã€‚
2.  **è®Šæ›´é‡æª¢æŸ¥**ï¼š
    - åŸ·è¡Œ `git diff --cached --stat`ã€‚è‹¥ç„¡è¼¸å‡ºï¼Œå‰‡åŸ·è¡Œ `git diff --stat` (ä¸¦æ¨™è¨˜éœ€åŸ·è¡Œ `git add`)ã€‚
    - **Guardrail**: è‹¥è®Šæ›´æª”æ¡ˆè¶…é **10 å€‹** æˆ– `insertions/deletions` è¶…é **500 è¡Œ**ï¼Œ**ä¸è®€å–å®Œæ•´ Diff**ã€‚åƒ…åˆ—å‡ºè®Šæ›´æª”æ¡ˆåˆ—è¡¨ï¼Œä¸¦è¦æ±‚ä½¿ç”¨è€…æä¾›æœ¬æ¬¡è®Šæ›´çš„ã€Œä¸€å¥è©±æ‘˜è¦ã€ä»¥è¼”åŠ©ç”Ÿæˆã€‚
3.  **ç²¾æº–è®€å–**ï¼š
    - è‹¥è®Šæ›´åœ¨å®‰å…¨ç¯„åœå…§ï¼ŒåŸ·è¡Œ `git diff --cached -U1` (è‹¥æš«å­˜å€ç‚ºç©ºå‰‡å»æ‰ `--cached`)ã€‚`-U1` åƒ…ä¿ç•™ 1 è¡Œä¸Šä¸‹æ–‡ä»¥ç¯€çœ Tokenã€‚

### Step 2: ç”Ÿæˆ Commit Message (Angular Convention)

åŸºæ–¼ Diff å…§å®¹ç”Ÿæˆç¬¦åˆ Angular è¦ç¯„çš„è¨Šæ¯ï¼š

- **Header**: `<type>(<scope>): <summary>` (ä¸­æ–‡)
  - `type`: feat, fix, docs, style, refactor, perf, test, chore, revert, build, ci.
  - `scope`: å—å½±éŸ¿çš„çµ„ä»¶æˆ–æª”æ¡ˆå¤¾åç¨± (å¯é¸)ã€‚
- **Body**:
  - ä½¿ç”¨åˆ—é» `- ` èªªæ˜å…·é«”è®Šæ›´ã€‚
  - è‹¥æœ‰å¤šå€‹é‚è¼¯è®Šæ›´ï¼Œè«‹åˆ†æ®µèªªæ˜ã€‚

### Step 3: é è¦½èˆ‡ç¢ºèª

è«‹è¼¸å‡ºä»¥ä¸‹å€å¡Šä¾›ä½¿ç”¨è€…ç¢ºèªï¼š

> **ğŸš€ Auto Commit æº–å‚™å°±ç·’**
> **ç•¶å‰åˆ†æ”¯**: `{{current_branch}}`
> **å»ºè­° Commit**:
>
> **è«‹é¸æ“‡ä¸‹ä¸€æ­¥ï¼š**
>
> - **[y]** åƒ…æäº¤ (Commit)
> - **[p]** æäº¤ä¸¦æ¨é€ (Commit & Push)
> - **[d]** æäº¤ã€æ¨é€ä¸¦ç™¼ PR åˆ° main (Commit, Push & PR)
> - **[n]** å–æ¶ˆ

### Step 4: åŸ·è¡Œ Git å‘½ä»¤

æ ¹æ“šä½¿ç”¨è€…é¸æ“‡åŸ·è¡Œï¼š

- **Case [y]**:
  1. `git add -A`
  2. `git commit -m "<æ¨™é¡Œ>" -m "<ç´°ç¯€1>" -m "<ç´°ç¯€2>"`
- **Case [p]**:
  1. åŸ·è¡Œ [y] çš„æ­¥é©Ÿã€‚
  2. `git push origin {{current_branch}}`
- **Case [d]**:
  1. åŸ·è¡Œ [p] çš„æ­¥é©Ÿã€‚
  2. é€²å…¥ **Step 5**ã€‚
- **Case [n]**:
  - ä¸åšä»»ä½•æ“ä½œï¼ŒçµæŸæµç¨‹ã€‚

### Step 5: è‡ªå‹•ç™¼ PR åˆ° main

**åƒ…åœ¨é¸æ“‡ [d] æ™‚åŸ·è¡Œï¼š**

1.  ä½¿ç”¨ `mcp_github_create_pull_request` å·¥å…·å»ºç«‹ Pull Requestï¼š
    - **owner / repo**ï¼šå¾ `git remote -v` ä¸­è§£æã€‚
    - **head**: `{{current_branch}}`
    - **base**: `main`
    - **title**: èˆ‡ Commit Header ç›¸åŒã€‚
    - **body**: åŒ…å«æœ¬æ¬¡ Commit çš„å®Œæ•´ Body å…§å®¹ï¼Œæ ¼å¼åŒ–ç‚º Markdown åˆ—è¡¨ã€‚
2.  è¼¸å‡º PR é€£çµä¸¦æç¤ºï¼šã€Œâœ… PR å·²å»ºç«‹ï¼Œè«‹å‰å¾€ GitHub ç¢ºèªæˆ–åˆä½µã€‚ã€
